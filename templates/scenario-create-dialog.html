<div id="scenario-create-dialog">
    <h2>Scenario Creator</h2>

    <div class="flex-container tab-navigation spaceBetween">
        <div class="flex-container">
            <button class="tab-button menu_button" data-tab="description">Description</button>
            <button class="tab-button menu_button" data-tab="first-message">First Message</button>
            <button class="tab-button menu_button" data-tab="scenario">Scenario</button>
            <button class="tab-button menu_button" data-tab="personality">Personality</button>
            <button class="tab-button menu_button" data-tab="character-note">Character Note</button>
        </div>
        <div class="flex-container justifyEnd gap10">
            <button id="import-scenario-btn" class="menu_button">Import</button>
            <div class="export-container" style="position: relative; padding-top: 5px; padding-bottom: 5px">
                <button
                    id="export-scenario-btn"
                    class="menu_button"
                    style="height: 100%; padding-top: 0px; padding-bottom: 0px; margin: 0"
                >
                    Export
                </button>
                <div
                    id="export-format-popup"
                    class="list-group"
                    style="display: none; position: absolute; z-index: 9999"
                >
                    <div class="export-format list-group-item" data-format="png">PNG</div>
                    <div class="export-format list-group-item" data-format="json">JSON</div>
                </div>
            </div>
            <button id="reset-scenario-btn" class="menu_button">Reset</button>
        </div>
    </div>

    <!-- Page Navigation -->
    <div class="flex-container page-navigation">
        <div class="flex-container">
            <div id="page-tab-buttons"></div>
            <div class="button-group">
                <button id="move-page-left-btn" class="menu_button" title="Move Page Left">
                    <i class="fa-solid fa-arrow-left"></i>
                </button>
                <button id="move-page-right-btn" class="menu_button" title="Move Page Right">
                    <i class="fa-solid fa-arrow-right"></i>
                </button>
            </div>
            <div class="button-group">
                <button id="add-question-btn" class="menu_button primary" title="Add New Question">
                    <i class="fa-solid fa-plus"></i> Question
                </button>
                <button id="add-page-btn" class="menu_button primary" title="Add New Page">
                    <i class="fa-solid fa-plus"></i> Page
                </button>
                <button id="remove-page-btn" class="menu_button danger" title="Remove Current Page">
                    <i class="fa-solid fa-trash"></i> Page
                </button>
            </div>
        </div>
    </div>

    <!-- Questions Container -->
    <div id="questions-container" class="questions-container">
        <div class="flex-container">
            <div id="dynamic-tab-buttons" class="questions-tabs"></div>
            <div class="button-group">
                <div style="display: flex">
                    <button id="move-question-left-btn" class="menu_button" title="Move Question Left">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                    <button id="move-question-right-btn" class="menu_button" title="Move Question Right">
                        <i class="fa-solid fa-arrow-right"></i>
                    </button>
                </div>
                <div>
                    <select id="page-select" class="text_pole" title="Select a page to move question to">
                        <option value="">None</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Contents -->
    <div class="tab-contents">
        <!-- Description Tab -->
        <div class="tab-content" data-tab="description">
            <div class="flex-container flexFlowColumn marginTopBot5">
                <div class="flex-container justifySpaceBetween alignItemsCenter flex1" title="Character description">
                    <label for="scenario-creator-character-description">Character description:</label>
                    <textarea
                        id="scenario-creator-character-description"
                        class="text_pole textarea_compact"
                        rows="4"
                        placeholder="Enter character description"
                    ></textarea>
                </div>
                <div class="accordion marginTop10">
                    <div class="accordion-header">
                        <button class="menu_button accordion-toggle">
                            <span class="accordion-icon">▼</span>
                            Script
                        </button>
                        <button id="refresh-preview" class="menu_button">Refresh Preview</button>
                    </div>
                    <div class="accordion-content">
                        <div
                            id="script-inputs-container"
                            class="flex-container flexFlowColumn marginTop10 marginBottom10"
                        >
                            <!-- Dynamic script inputs will be added here -->
                        </div>
                        <textarea
                            id="scenario-creator-script"
                            class="text_pole textarea_compact"
                            rows="8"
                            placeholder="Enter your script here..."
                        ></textarea>
                    </div>
                </div>
                <div class="flex-container flexFlowColumn marginTop10">
                    <label>Preview:</label>
                    <div
                        id="description-preview"
                        class="text_pole"
                        style="overflow-y: auto; overflow-x: hidden; max-height: 150px"
                    >
                        Preview will appear here...
                    </div>
                </div>
            </div>
        </div>

        <!-- First Message Tab -->
        <div class="tab-content" data-tab="first-message">
            <div class="flex-container flexFlowColumn marginTopBot5">
                <div class="flex-container justifySpaceBetween alignItemsCenter flex1" title="First message">
                    <label for="scenario-creator-character-first-message">First message:</label>
                    <textarea
                        id="scenario-creator-character-first-message"
                        class="text_pole textarea_compact"
                        rows="4"
                        placeholder="Enter first message"
                    ></textarea>
                </div>
                <div class="accordion marginTop10">
                    <div class="accordion-header">
                        <button class="menu_button accordion-toggle">
                            <span class="accordion-icon">▼</span>
                            Script
                        </button>
                        <button id="refresh-first-message-preview" class="menu_button">Refresh Preview</button>
                    </div>
                    <div class="accordion-content">
                        <div
                            id="first-message-script-inputs-container"
                            class="flex-container flexFlowColumn marginTop10 marginBottom10"
                        >
                            <!-- Dynamic script inputs will be added here -->
                        </div>
                        <textarea
                            id="scenario-creator-first-message-script"
                            class="text_pole textarea_compact"
                            rows="8"
                            placeholder="Enter your script here..."
                        ></textarea>
                    </div>
                </div>
                <div class="flex-container flexFlowColumn marginTop10">
                    <label>Preview:</label>
                    <div
                        id="first-message-preview"
                        class="text_pole"
                        style="overflow-y: auto; overflow-x: hidden; max-height: 150px"
                    >
                        Preview will appear here...
                    </div>
                </div>
            </div>
        </div>

        <!-- Scenario Tab -->
        <div class="tab-content" data-tab="scenario">
            <div class="flex-container flexFlowColumn marginTopBot5">
                <div class="flex-container justifySpaceBetween alignItemsCenter flex1" title="Scenario">
                    <label for="scenario-creator-character-scenario">Scenario:</label>
                    <textarea
                        id="scenario-creator-character-scenario"
                        class="text_pole textarea_compact"
                        rows="4"
                        placeholder="Enter scenario"
                    ></textarea>
                </div>
                <div class="accordion marginTop10">
                    <div class="accordion-header">
                        <button class="menu_button accordion-toggle">
                            <span class="accordion-icon">▼</span>
                            Script
                        </button>
                        <button id="refresh-scenario-preview" class="menu_button">Refresh Preview</button>
                    </div>
                    <div class="accordion-content">
                        <div
                            id="scenario-script-inputs-container"
                            class="flex-container flexFlowColumn marginTop10 marginBottom10"
                        >
                            <!-- Dynamic script inputs will be added here -->
                        </div>
                        <textarea
                            id="scenario-creator-scenario-script"
                            class="text_pole textarea_compact"
                            rows="8"
                            placeholder="Enter your script here..."
                        ></textarea>
                    </div>
                </div>
                <div class="flex-container flexFlowColumn marginTop10">
                    <label>Preview:</label>
                    <div
                        id="scenario-preview"
                        class="text_pole"
                        style="overflow-y: auto; overflow-x: hidden; max-height: 150px"
                    >
                        Preview will appear here...
                    </div>
                </div>
            </div>
        </div>

        <!-- Personality Tab -->
        <div class="tab-content" data-tab="personality">
            <div class="flex-container flexFlowColumn marginTopBot5">
                <div class="flex-container justifySpaceBetween alignItemsCenter flex1" title="Personality">
                    <label for="scenario-creator-character-personality">Personality:</label>
                    <textarea
                        id="scenario-creator-character-personality"
                        class="text_pole textarea_compact"
                        rows="4"
                        placeholder="Enter personality"
                    ></textarea>
                </div>
                <div class="accordion marginTop10">
                    <div class="accordion-header">
                        <button class="menu_button accordion-toggle">
                            <span class="accordion-icon">▼</span>
                            Script
                        </button>
                        <button id="refresh-personality-preview" class="menu_button">Refresh Preview</button>
                    </div>
                    <div class="accordion-content">
                        <div
                            id="personality-script-inputs-container"
                            class="flex-container flexFlowColumn marginTop10 marginBottom10"
                        >
                            <!-- Dynamic script inputs will be added here -->
                        </div>
                        <textarea
                            id="scenario-creator-personality-script"
                            class="text_pole textarea_compact"
                            rows="8"
                            placeholder="Enter your script here..."
                        ></textarea>
                    </div>
                </div>
                <div class="flex-container flexFlowColumn marginTop10">
                    <label>Preview:</label>
                    <div
                        id="personality-preview"
                        class="text_pole"
                        style="overflow-y: auto; overflow-x: hidden; max-height: 150px"
                    >
                        Preview will appear here...
                    </div>
                </div>
            </div>
        </div>

        <!-- Character Note Tab -->
        <div class="tab-content" data-tab="character-note">
            <div class="flex-container flexFlowColumn marginTopBot5">
                <div class="flex-container justifySpaceBetween alignItemsCenter flex1" title="Character Note">
                    <label for="scenario-creator-character-note">Character Note:</label>
                    <textarea
                        id="scenario-creator-character-note"
                        class="text_pole textarea_compact"
                        rows="4"
                        placeholder="Enter character note"
                    ></textarea>
                </div>
                <div class="accordion marginTop10">
                    <div class="accordion-header">
                        <button class="menu_button accordion-toggle">
                            <span class="accordion-icon">▼</span>
                            Script
                        </button>
                        <button id="refresh-character-note-preview" class="menu_button">Refresh Preview</button>
                    </div>
                    <div class="accordion-content">
                        <div
                            id="character-note-script-inputs-container"
                            class="flex-container flexFlowColumn marginTop10 marginBottom10"
                        >
                            <!-- Dynamic script inputs will be added here -->
                        </div>
                        <textarea
                            id="scenario-creator-character-note-script"
                            class="text_pole textarea_compact"
                            rows="8"
                            placeholder="Enter your script here..."
                        ></textarea>
                    </div>
                </div>
                <div class="flex-container flexFlowColumn marginTop10">
                    <label>Preview:</label>
                    <div
                        id="character-note-preview"
                        class="text_pole"
                        style="overflow-y: auto; overflow-x: hidden; max-height: 150px"
                    >
                        Preview will appear here...
                    </div>
                </div>
            </div>
        </div>

        <!-- Dynamic Questions Container -->
        <div id="dynamic-inputs-container"></div>
    </div>

    <!-- Template for dynamic input -->
    <template id="dynamic-input-template">
        <div class="tab-content dynamic-input-group" data-tab="question-{id}">
            <div class="flex-container flexFlowColumn marginTop10">
                <div class="flex-container question-header gap10">
                    <div class="flex1">
                        <label>Type: </label>
                        <select class="text_pole input-type-select">
                            <option value="text">Text</option>
                            <option value="select">Select</option>
                            <option value="checkbox">Checkbox</option>
                        </select>
                    </div>
                    <div class="flex2">
                        <label>ID: </label>
                        <input
                            type="text"
                            class="text_pole input-id"
                            placeholder="Enter ID (e.g., character_name)"
                            title="This ID will be used as {{answer_id}} in templates"
                        />
                    </div>
                </div>
                <div class="flex-container flexFlowColumn marginTop10">
                    <label>Question:</label>
                    <textarea
                        class="text_pole textarea_compact input-question"
                        rows="2"
                        placeholder="Enter question"
                    ></textarea>
                </div>
                <div class="accordion marginTop10">
                    <div class="accordion-header">
                        <button class="menu_button accordion-toggle">
                            <span class="accordion-icon">▼</span>
                            Script
                        </button>
                        <button class="refresh-question-preview menu_button">Refresh Preview</button>
                    </div>
                    <div class="accordion-content">
                        <div
                            class="question-script-inputs-container flex-container flexFlowColumn marginTop10 marginBottom10"
                        >
                            <!-- Dynamic script inputs will be added here -->
                        </div>
                        <textarea
                            class="text_pole textarea_compact question-script"
                            rows="8"
                            placeholder="Enter your main script here..."
                        ></textarea>
                        <textarea
                            class="text_pole textarea_compact show-script"
                            rows="4"
                            placeholder="Enter your show script here..."
                        ></textarea>
                        <label>Preview: </label>
                        <label class="show-preview">SHOW</label>
                    </div>
                </div>
                <div class="flex-container flexFlowColumn marginTop10">
                    <label>Preview:</label>
                    <pre
                        class="question-preview text_pole"
                        style="overflow-y: auto; overflow-x: hidden; max-height: 150px"
                    >
                        Preview will appear here...
                    </pre>
                </div>
                <div class="flex-container alignItemsCenter marginTop10">
                    <label class="checkbox_label">
                        <input type="checkbox" class="input-required" />
                        Required
                    </label>
                </div>
                <!-- Select Options Section -->
                <div class="select-options-container" style="display: none">
                    <div class="flex-container flexFlowColumn marginTop10">
                        <div class="flex-container justifySpaceBetween alignItemsCenter">
                            <label>Options:</label>
                            <button class="menu_button add-option-btn">+ Add Option</button>
                        </div>
                        <div class="options-list"></div>
                    </div>
                </div>
                <!-- Default Value Section -->
                <div class="default-value-container">
                    <div class="flex-container flexFlowColumn marginTop10">
                        <label>Default Value:</label>
                        <div class="default-value-input-container">
                            <textarea
                                class="text_pole textarea_compact input-default"
                                rows="2"
                                placeholder="Enter default value"
                            ></textarea>
                            <label class="checkbox_label checkbox-default" style="display: none">
                                <input type="checkbox" class="input-default-checkbox" />
                                Checked by default
                            </label>
                            <select class="text_pole select-default" style="display: none">
                                <option value="">Select a default value</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Template for page button -->
    <template id="page-button-template">
        <div class="page-button-container">
            <button class="page-button menu_button" data-page="{page}">Page {page}</button>
        </div>
    </template>

    <!-- Template for tab button -->
    <template id="tab-button-template">
        <div class="tab-button-container" data-page="{page}">
            <button class="tab-button menu_button question" data-tab="question-{id}">Question {id}</button>
            <button class="remove-input-btn menu_button danger" title="Remove Question">
                <i class="fa-solid fa-trash"></i>
            </button>
        </div>
    </template>

    <!-- Template for select option -->
    <template id="select-option-template">
        <div class="flex-container option-item marginTop5">
            <div class="flex-container flex1 gap10">
                <input type="text" class="text_pole option-label flex1" placeholder="Enter option label" />
                <input type="text" class="text_pole option-value flex1" placeholder="Enter option value" />
            </div>
            <button class="menu_button remove-option-btn marginLeft10" title="Remove Option">×</button>
        </div>
    </template>
</div>
