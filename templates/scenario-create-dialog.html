<div id="scenario-create-dialog">
    <h2>Scenario Creator</h2>

    <!-- Tab Navigation -->
    <div class="flex-container tab-navigation">
        <button class="tab-button menu_button" data-tab="description">Description</button>
        <button class="tab-button menu_button" data-tab="first-message">First Message</button>
        <div id="dynamic-tab-buttons"></div>
        <button id="add-input-btn" class="menu_button">+ Add Question</button>
    </div>

    <!-- Tab Contents -->
    <div class="tab-contents">
        <!-- Description Tab -->
        <div class="tab-content" data-tab="description">
            <div class="flex-container flexFlowColumn marginTopBot5">
                <div class="flex-container justifySpaceBetween alignItemsCenter flex1" title="Character description">
                    <label for="scenario-creator-character-description">Character description:</label>
                    <textarea id="scenario-creator-character-description" class="text_pole textarea_compact" rows="4"
                        placeholder="Enter character description">{{description}}</textarea>
                </div>
                <div class="accordion marginTop10">
                    <div class="accordion-header">
                        <button class="menu_button accordion-toggle">
                            <span class="accordion-icon">▼</span>
                            Script
                        </button>
                        <button id="refresh-preview" class="menu_button">Refresh Preview</button>
                    </div>
                    <div class="accordion-content">
                        <div id="script-inputs-container"
                            class="flex-container flexFlowColumn marginTop10 marginBottom10">
                            <!-- Dynamic script inputs will be added here -->
                        </div>
                        <textarea id="scenario-creator-script" class="text_pole textarea_compact" rows="8"
                            placeholder="Enter your script here..."></textarea>
                    </div>
                </div>
                <div class="flex-container flexFlowColumn marginTop10">
                    <label>Preview:</label>
                    <div id="description-preview" class="text_pole">
                        Preview will appear here...
                    </div>
                </div>
            </div>
        </div>

        <!-- First Message Tab -->
        <div class="tab-content" data-tab="first-message">
            <div class="flex-container marginTopBot5">
                <div class="flex-container justifySpaceBetween alignItemsCenter flex1" title="First message">
                    <label for="scenario-creator-character-first-message">First message:</label>
                    <textarea id="scenario-creator-character-first-message" class="text_pole textarea_compact" rows="4"
                        placeholder="Enter first message">{{first_message}}</textarea>
                </div>
            </div>
        </div>

        <!-- Dynamic Questions Container -->
        <div id="dynamic-inputs-container"></div>
    </div>

    <!-- Template for dynamic input -->
    <template id="dynamic-input-template">
        <div class="tab-content dynamic-input-group" data-tab="question-{id}">
            <div class="flex-container flexFlowColumn marginTop10">
                <div class="flex-container question-header gap10">
                    <div class="flex1">
                        <select class="text_pole input-type-select">
                            <option value="textarea">Textarea</option>
                            <option value="select">Select</option>
                            <option value="checkbox">Checkbox</option>
                        </select>
                    </div>
                    <div class="flex2">
                        <input type="text" class="text_pole input-id" placeholder="Enter ID (e.g., character_name)"
                            title="This ID will be used as {{answer_id}} in templates">
                    </div>
                </div>
                <div class="flex-container flexFlowColumn marginTop10">
                    <label>Question:</label>
                    <textarea class="text_pole textarea_compact input-question" rows="2"
                        placeholder="Enter question"></textarea>
                </div>
                <div class="flex-container alignItemsCenter marginTop10">
                    <label class="checkbox_label">
                        <input type="checkbox" class="input-required">
                        Required
                    </label>
                </div>
                <!-- Select Options Section -->
                <div class="select-options-container" style="display: none;">
                    <div class="flex-container flexFlowColumn marginTop10">
                        <div class="flex-container justifySpaceBetween alignItemsCenter">
                            <label>Options:</label>
                            <button class="menu_button add-option-btn">+ Add Option</button>
                        </div>
                        <div class="options-list"></div>
                    </div>
                </div>
                <!-- Default Value Section -->
                <div class="default-value-container">
                    <div class="flex-container flexFlowColumn marginTop10">
                        <label>Default Value:</label>
                        <div class="default-value-input-container">
                            <textarea class="text_pole textarea_compact input-default" rows="2"
                                placeholder="Enter default value"></textarea>
                            <label class="checkbox_label checkbox-default" style="display: none;">
                                <input type="checkbox" class="input-default-checkbox">
                                Checked by default
                            </label>
                            <select class="text_pole select-default" style="display: none;">
                                <option value="">Select a default value</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Template for tab button -->
    <template id="tab-button-template">
        <div class="tab-button-container">
            <button class="tab-button menu_button" data-tab="question-{id}">Question {number}</button>
            <button class="remove-input-btn menu_button" title="Remove Question">×</button>
        </div>
    </template>

    <!-- Template for select option -->
    <template id="select-option-template">
        <div class="flex-container option-item marginTop5">
            <div class="flex-container flex1 gap10">
                <input type="text" class="text_pole option-label flex1" placeholder="Enter option label">
                <input type="text" class="text_pole option-value flex1" placeholder="Enter option value">
            </div>
            <button class="menu_button remove-option-btn marginLeft10" title="Remove Option">×</button>
        </div>
    </template>
</div>

<style>
    .tab-navigation {
        gap: 5px;
        margin-bottom: 10px;
        flex-wrap: wrap;
    }

    .tab-button {
        min-width: auto;
    }

    .tab-button.active {
        background-color: var(--accent-color);
    }

    .tab-content {
        display: none;
    }

    .tab-content.active {
        display: block;
    }

    #dynamic-tab-buttons {
        display: flex;
        gap: 5px;
    }

    .tab-button-container {
        display: flex;
        gap: 2px;
    }

    .remove-input-btn {
        padding: 0 8px;
        min-width: auto;
        font-size: 16px;
        line-height: 1;
    }

    .gap10 {
        gap: 10px;
    }

    .marginLeft10 {
        margin-left: 10px;
    }

    .marginBottom10 {
        margin-bottom: 10px;
    }

    .accordion {
        border: 1px solid var(--accent-color);
        border-radius: 5px;
    }

    .accordion-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        gap: 10px;
    }

    .accordion-toggle {
        display: flex;
        align-items: center;
        gap: 5px;
        cursor: pointer;
        flex: 1;
        text-align: left;
    }

    .accordion-icon {
        display: inline-block;
        transition: transform 0.3s;
    }

    .accordion-content {
        padding: 10px;
        display: none;
    }

    .accordion.open .accordion-content {
        display: block;
    }

    .accordion.open .accordion-icon {
        transform: rotate(180deg);
    }

    .script-input-group {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-bottom: 5px;
    }

    .script-input-group label {
        min-width: 100px;
    }

    .script-input-group input {
        flex: 1;
    }

    .flex2 {
        flex: 2;
    }

    #description-preview {
        min-height: 100px;
        padding: 10px;
        white-space: pre-wrap;
        overflow-wrap: break-word;
    }
</style>
